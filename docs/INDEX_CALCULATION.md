# Index 分數計算說明

## 📊 概述

我們使用**標準化（Normalization）**方法來計算各種指數，將不同單位的資料（犯罪數、房價）轉換為 0-100 的分數，方便比較和視覺化。

## 🔢 標準化方法

### Min-Max 標準化

我們使用 **Min-Max Normalization** 將原始資料標準化到 0-100 範圍：

```
標準化分數 = (原始值 - 最小值) / (最大值 - 最小值) × 100
```

**優點**：
- 簡單易懂
- 結果在 0-100 範圍內，容易解釋
- 保留原始資料的相對關係

**是否需要標準化？**
✅ **是的，必須標準化**，因為：
1. 犯罪數和房價的單位和範圍完全不同（犯罪數：2-496，房價：$240K-$1.3M）
2. 標準化後可以公平地比較不同 ZIP Code
3. 可以結合不同指標計算綜合指數

## 📈 計算的指數

### 1. 安全指數 (Safety Index)
- **範圍**: 0-100
- **說明**: 分數越高表示越安全（犯罪數越少）
- **計算**: `100 - (犯罪數標準化分數)`
- **用途**: 評估區域安全性

### 2. 可負擔性指數 (Affordability Index)
- **範圍**: 0-100
- **說明**: 分數越高表示房價越可負擔（房價越低）
- **計算**: `100 - (房價標準化分數)`
- **用途**: 評估房價可負擔性
- **注意**: 如果沒有房價資料，此指數為 `null`

### 3. 房價高級指數 (Premium Index)
- **範圍**: 0-100
- **說明**: 分數越高表示房價越高
- **計算**: 房價標準化分數（不反向）
- **用途**: 評估房價水準
- **注意**: 如果沒有房價資料，此指數為 `null`

### 4. 生活品質指數 (Quality of Life Index) ⭐
- **範圍**: 0-100
- **說明**: 綜合安全和可負擔性的生活品質評分
- **計算**: `安全指數 × 60% + 可負擔性指數 × 40%`
- **用途**: 評估整體生活品質（主要指數）
- **如果沒有房價資料**: 只使用安全指數

### 5. 投資價值指數 (Investment Index)
- **範圍**: 0-100
- **說明**: 綜合房價和安全性的投資價值評分
- **計算**: `房價標準化分數 × 60% + 安全指數 × 40%`
- **用途**: 評估投資潛力（高房價 + 低犯罪 = 高投資價值）
- **如果沒有房價資料**: 只使用安全指數

### 6. 犯罪風險指數 (Crime Index)
- **範圍**: 0-100
- **說明**: 分數越高表示犯罪風險越高（與安全指數相反）
- **計算**: `100 - 安全指數`
- **用途**: 評估犯罪風險

## 🎯 權重設定

### 生活品質指數
- **安全權重**: 60%
- **可負擔性權重**: 40%

### 投資價值指數
- **房價權重**: 60%
- **安全權重**: 40%

**為什麼這樣設定？**
- 安全對生活品質更重要，所以權重較高
- 投資價值更注重房價，所以房價權重較高
- 可以根據需求調整權重

## 📊 資料範圍

根據當前資料：

### 犯罪數範圍
- **最小**: 2 筆
- **最大**: 496 筆
- **平均**: 123.2 筆
- **中位數**: 104 筆

### 房價範圍
- **最小**: $240,203
- **最大**: $1,346,126
- **平均**: $633,657
- **中位數**: $566,017

### 生活品質指數範圍
- **最小**: 26.3
- **最大**: 100.0
- **平均**: 74.2
- **中位數**: 72.6

## 💡 使用範例

### JSON 結構

```json
{
  "data": {
    "20002": {
      "indices": {
        "safety_index": 75.5,
        "affordability_index": 45.2,
        "premium_index": 54.8,
        "quality_of_life_index": 63.4,
        "investment_index": 58.1,
        "crime_index": 24.5
      }
    }
  },
  "metadata": {
    "index_ranges": {
      "crime_range": {"min": 2, "max": 496},
      "price_range": {"min": 240203.0, "max": 1346126.0}
    }
  }
}
```

### 前端使用

```javascript
const zipData = data.data['20002'];
const qualityIndex = zipData.indices.quality_of_life_index;

if (qualityIndex >= 80) {
  console.log('生活品質優秀');
} else if (qualityIndex >= 60) {
  console.log('生活品質良好');
} else {
  console.log('生活品質需要改善');
}
```

## 🔄 更新 Index

當資料更新時，需要重新計算 Index：

```bash
python scripts/combine_data_to_json.py
```

這會：
1. 重新讀取 Crime 和 Zillow 資料
2. 重新計算統計範圍
3. 重新計算所有 ZIP Code 的指數
4. 更新 JSON 檔案

## 📝 注意事項

1. **標準化是必須的**: 不同單位的資料無法直接比較
2. **權重可以調整**: 根據研究需求調整權重
3. **缺失資料處理**: 如果沒有房價資料，相關指數為 `null`
4. **定期更新**: 當資料更新時，需要重新計算 Index

## 🎨 視覺化建議

### 顏色建議
- **生活品質指數 80+**: 🟢 綠色（優秀）
- **生活品質指數 60-80**: 🟡 黃色（良好）
- **生活品質指數 <60**: 🔴 紅色（需要改善）

### 圖表建議
- 使用進度條顯示指數
- 使用熱力圖顯示不同 ZIP Code 的指數
- 使用散點圖比較安全指數和可負擔性指數

## 📚 參考資料

- [Min-Max Normalization](https://en.wikipedia.org/wiki/Feature_scaling#Rescaling_(min-max_normalization))
- [Data Standardization](https://www.statisticshowto.com/normalized-data/)

---

需要調整權重或計算方法嗎？請告訴我！

